<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>50 Sounds Practice / æ—¥æ–‡äº”åéŸ³ç·´ç¿’å™¨</title>
    <style>
        body { font-family: "Helvetica", sans-serif; text-align: center; margin: 40px; background: #f7f7f7; }
        h1 { color: #2c3e50; }
        input, button, select { padding: 10px; font-size: 16px; }
        .kana { font-size: 72px; margin: 20px; }
        .result { font-size: 18px; margin-top: 20px; }
        .quiz-container { display: flex; justify-content: center; align-items: center; gap: 30px; margin-top: 30px; }
        #mode-select label { margin-right: 10px; }
        /* è¡Œé¸å–ä¸‰çµ„ç›´æ’ */
        #checkbox-mode { display: flex; justify-content: center; gap: 40px; margin-top: 10px; }
        .group { display: flex; flex-direction: column; align-items: flex-start; }
        .group label { margin: 5px 0; }
        /* éš±è—è¡Œæ¨¡å¼çš„æŒ‰éˆ•å®¹å™¨ï¼Œåˆ‡æ›æ™‚é¡¯ç¤º */
        #checkbox-start-btn { display: none; margin-top: 20px; }

    </style>
</head>
<body>
    <h1 id="title">ğŸŒ æ—¥æ–‡äº”åéŸ³ç·´ç¿’å™¨</h1>

    <!-- èªè¨€é¸æ“‡ (å§‹çµ‚å¯è¦‹) -->
    <label for="language">ğŸŒ èªè¨€ Language:</label>
    <select id="language" onchange="setLanguage()">
        <option value="zh">ç¹é«”ä¸­æ–‡</option>
        <option value="en">English</option>
    </select>

    <!-- æ¨¡å¼é¸æ“‡ -->
    <div id="mode-select" style="margin-top:20px;">
        <label><input type="radio" name="mode" value="range" checked onchange="toggleMode(this.value)"><span id="label-range">ç¯„åœè¼¸å…¥</span></label>
        <label><input type="radio" name="mode" value="checkbox" onchange="toggleMode(this.value)"><span id="label-checkbox">è¡Œé¸å–</span></label>
    </div>

    <!-- ç¯„åœè¼¸å…¥æ¨¡å¼ -->
    <div id="range-mode" style="margin-top:10px;">
        <p id="instructions">è¼¸å…¥èµ·å§‹èˆ‡çµæŸå‡åï¼ˆä¾‹å¦‚ï¼šã‚ åˆ° ã“ï¼‰ï¼š</p>
        <input id="start" placeholder="èµ·å§‹å‡å"> ã€œ
        <input id="end" placeholder="çµæŸå‡å">
        <button class="startBtn" onclick="startQuiz()">é–‹å§‹ç·´ç¿’</button>
    </div>

    <!-- è¡Œé¸å–æ¨¡å¼ -->
    <div id="checkbox-mode" style="display:none;">
        <div class="group">
            <label><input type="checkbox" name="row" value="a"><span class="row-label" data-row="a">ã‚è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="k"><span class="row-label" data-row="k">ã‹è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="s"><span class="row-label" data-row="s">ã•è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="t"><span class="row-label" data-row="t">ãŸè¡Œ</span></label>
            <label><input type="checkbox" name="row" value="n"><span class="row-label" data-row="n">ãªè¡Œ</span></label>
        </div>
        <div class="group">
            <label><input type="checkbox" name="row" value="h"><span class="row-label" data-row="h">ã¯è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="m"><span class="row-label" data-row="m">ã¾è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="y"><span class="row-label" data-row="y">ã‚„è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="r"><span class="row-label" data-row="r">ã‚‰è¡Œ</span></label>
            <label><input type="checkbox" name="row" value="w"><span class="row-label" data-row="w">ã‚è¡Œ</span></label>
        </div>
        <div class="group">
            <label><input type="checkbox" name="row" value="nn"><span class="row-label" data-row="nn">ã‚“è¡Œ</span></label>
        </div>
    </div>

    <!-- è¡Œé¸å–çš„é–‹å§‹æŒ‰éˆ• -->
    <div id="checkbox-start-btn">
        <button class="startBtn" onclick="startQuiz()">é–‹å§‹ç·´ç¿’</button>
    </div>

    <!-- æ¸¬é©—å€ -->
    <div id="quiz" style="display:none;">
        <div class="quiz-container" style="flex-direction: column;">
            <div class="kana" id="kana"></div>
            <input id="answer" placeholder="è¼¸å…¥ç¾…é¦¬æ‹¼éŸ³" onkeydown="if(event.key==='Enter') checkAnswer()">
            <button onclick="checkAnswer()" id="submitBtn">é€å‡º</button>
            <div class="result" id="feedback"></div>
            <img src="å’–æ³¢ç¨®å­.gif" alt="å’–æ³¢ç¨®å­ GIF" style="width:300px; height:auto; margin-top: 20px;">
        </div>
    </div>

    <script>
    const chart = [
        ["ã‚","a"],["ã„","i"],["ã†","u"],["ãˆ","e"],["ãŠ","o"],
        ["ã‹","ka"],["ã","ki"],["ã","ku"],["ã‘","ke"],["ã“","ko"],
        ["ã•","sa"],["ã—","shi"],["ã™","su"],["ã›","se"],["ã","so"],
        ["ãŸ","ta"],["ã¡","chi"],["ã¤","tsu"],["ã¦","te"],["ã¨","to"],
        ["ãª","na"],["ã«","ni"],["ã¬","nu"],["ã­","ne"],["ã®","no"],
        ["ã¯","ha"],["ã²","hi"],["ãµ","fu"],["ã¸","he"],["ã»","ho"],
        ["ã¾","ma"],["ã¿","mi"],["ã‚€","mu"],["ã‚","me"],["ã‚‚","mo"],
        ["ã‚„","ya"],["ã‚†","yu"],["ã‚ˆ","yo"],
        ["ã‚‰","ra"],["ã‚Š","ri"],["ã‚‹","ru"],["ã‚Œ","re"],["ã‚","ro"],
        ["ã‚","wa"],["ã‚’","wo"],["ã‚“","n"]
    ];
    
    const rowMap = {
        a:["ã‚","ã„","ã†","ãˆ","ãŠ"], k:["ã‹","ã","ã","ã‘","ã“"],
        s:["ã•","ã—","ã™","ã›","ã"], t:["ãŸ","ã¡","ã¤","ã¦","ã¨"],
        n:["ãª","ã«","ã¬","ã­","ã®"], h:["ã¯","ã²","ãµ","ã¸","ã»"],
        m:["ã¾","ã¿","ã‚€","ã‚","ã‚‚"], y:["ã‚„","ã‚†","ã‚ˆ"],
        r:["ã‚‰","ã‚Š","ã‚‹","ã‚Œ","ã‚"], w:["ã‚","ã‚’"], nn:["ã‚“"]
    };
    
    const rowKana = { a:"ã‚", k:"ã‹", s:"ã•", t:"ãŸ", n:"ãª", h:"ã¯", m:"ã¾", y:"ã‚„", r:"ã‚‰", w:"ã‚", nn:"ã‚“" };
    const romajiToKana = Object.fromEntries(chart.map(([k,r])=>[r,k]));
    
    let selected=[], current=0, score=0, lang="zh";
    
    const texts={
        zh:{ 
            title:"ğŸŒ æ—¥æ–‡äº”åéŸ³ç·´ç¿’å™¨", 
            instructions:"è¼¸å…¥èµ·å§‹èˆ‡çµæŸå‡åï¼ˆä¾‹å¦‚ï¼šã‚ åˆ° ã“ï¼‰ï¼š", 
            checkboxLabel:"é¸æ“‡è¦ç·´ç¿’çš„è¡Œï¼š", 
            startBtn:"é–‹å§‹ç·´ç¿’", 
            submitBtn:"é€å‡º", 
            correct:"âœ… æ­£ç¢ºï¼", 
            wrong:c=>`âŒ éŒ¯èª¤ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ ${c}`, 
            score:(s,t)=>`ğŸŒŸ å¾—åˆ†ï¼š${s} / ${t}`, 
            alert:"âš ï¸ è«‹å…ˆé¸æ“‡æœ‰æ•ˆç¯„åœæˆ–è‡³å°‘ä¸€å€‹è¡Œï¼", 
            modeRange:"ç¯„åœè¼¸å…¥", 
            modeCheckbox:"è¡Œé¸å–"
        },
        en:{ 
            title:"ğŸŒ 50 Sounds Practice", 
            instructions:"Enter start and end kana (e.g., ã‚ to ã“):", 
            checkboxLabel:"Select rows to practice:", 
            startBtn:"Start Quiz", 
            submitBtn:"Submit", 
            correct:"âœ… Correct!", 
            wrong:c=>`âŒ Incorrect, correct answer: ${c}`, 
            score:(s,t)=>`ğŸŒŸ Score: ${s} / ${t}`, 
            alert:"âš ï¸ Invalid range or no row selected!", 
            modeRange:"Range Input", 
            modeCheckbox:"Select Rows"
        }
    };
    
    function setLanguage(){
        lang=document.getElementById("language").value;
        const t=texts[lang];
        document.getElementById("title").innerText=t.title;
        document.getElementById("instructions").innerText=t.instructions;
        document.getElementById("label-range").innerText=t.modeRange;
        document.getElementById("label-checkbox").innerText=t.modeCheckbox;
        document.querySelectorAll(".startBtn").forEach(b=>b.innerText=t.startBtn);
        document.getElementById("submitBtn").innerText=t.submitBtn;
        document.getElementById("answer").placeholder=lang==="en"?"Enter romaji":"è¼¸å…¥ç¾…é¦¬æ‹¼éŸ³";
        document.getElementById("start").placeholder=lang==="en"?"Start kana (e.g. a)":"èµ·å§‹å‡å";
        document.getElementById("end").placeholder=lang==="en"?"End kana (e.g. ko)":"çµæŸå‡å";
        document.querySelectorAll('.row-label').forEach(span=>{
            const r=span.dataset.row;
            span.innerText=lang==="en"?`${rowKana[r]} row`:`${rowKana[r]}è¡Œ`;
        });
    }
    
    function toggleMode(v){
        document.getElementById('range-mode').style.display=v==='range'?'block':'none';
        document.getElementById('checkbox-mode').style.display=v==='checkbox'?'flex':'none';
        document.getElementById('checkbox-start-btn').style.display=v==='checkbox'?'block':'none';
    }
    
    function normalize(input){
        if(chart.find(p=>p[0]===input)) return input;
        return romajiToKana[input.toLowerCase()]||"";
    }
    
    function shuffle(array) {
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
    }
    
    function startQuiz(){
        const mode=document.querySelector('input[name="mode"]:checked').value;
        let kanaList=[];
        
        if(mode==='range'){
            const s=normalize(document.getElementById("start").value.trim());
            const e=normalize(document.getElementById("end").value.trim());
            const si=chart.findIndex(p=>p[0]===s), ei=chart.findIndex(p=>p[0]===e);
            if(si<0||ei<0||si>ei){alert(texts[lang].alert);return;}
            kanaList=chart.slice(si,ei+1);
        } else {
            const checks=Array.from(document.querySelectorAll('input[name="row"]:checked')).map(cb=>cb.value);
            if(!checks.length){alert(texts[lang].alert);return;}
            checks.forEach(r=>rowMap[r].forEach(k=>kanaList.push([k,chart.find(c=>c[0]===k)[1]])));
        }
        
        selected=shuffle(kanaList);
        current=0;
        score=0;
        document.getElementById("quiz").style.display="block";
        document.getElementById("feedback").innerText="";
        document.getElementById("answer").style.display="inline";
        document.getElementById("submitBtn").style.display="inline";
        nextQuestion();
    }
    
    function nextQuestion(){
        if(current>=selected.length){
            document.getElementById("kana").innerText=texts[lang].score(score,selected.length);
            document.getElementById("answer").style.display="none";
            document.getElementById("submitBtn").style.display="none";
            document.getElementById("feedback").innerText="";
            return;
        }
        document.getElementById("kana").innerText=selected[current][0];
        document.getElementById("answer").value="";
        document.getElementById("answer").focus();
        document.getElementById("feedback").innerText="";
    }
    
    function checkAnswer(){
        const user=document.getElementById("answer").value.trim().toLowerCase();
        const char=selected[current][0];
        const corrects=char==="ã‚’"?["wo","o"]:[selected[current][1]];
        const feedback=document.getElementById("feedback");
        
        if(corrects.includes(user)){
            feedback.innerText=texts[lang].correct;
            feedback.style.color="#27ae60";
            score++;
        } else {
            feedback.innerText=texts[lang].wrong(corrects[0]);
            feedback.style.color="#e74c3c";
        }
        
        current++;
        setTimeout(nextQuestion, 1500);
    }
    
    // åˆå§‹åŒ–èªè¨€è¨­å®š
    setLanguage();
    </script>
</body>
</html>
