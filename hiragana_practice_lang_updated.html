
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æ—¥æ–‡äº”åéŸ³ç·´ç¿’å™¨ / Hiragana Practice</title>
    <style>
        body { font-family: "Helvetica", sans-serif; text-align: center; margin: 40px; background: #f7f7f7; }
        h1 { color: #2c3e50; }
        input, button, select { padding: 10px; font-size: 16px; }
        .kana { font-size: 72px; margin: 20px; }
        .result { font-size: 18px; margin-top: 20px; }
    </style>
</head>
<body>
    <h1 id="title">ğŸŒ æ—¥æ–‡äº”åéŸ³ç·´ç¿’å™¨</h1>

    <label for="language">ğŸŒ èªè¨€ Language:</label>
    <select id="language" onchange="setLanguage()">
        <option value="zh">ç¹é«”ä¸­æ–‡</option>
        <option value="en">English</option>
    </select>

    <p id="instructions">è¼¸å…¥èµ·å§‹èˆ‡çµæŸå‡åï¼ˆä¾‹å¦‚ï¼šã‚ åˆ° ã“ï¼‰ï¼š</p>
    <input id="start" placeholder="èµ·å§‹å‡å"> ã€œ 
    <input id="end" placeholder="çµæŸå‡å">
    <button onclick="startQuiz()" id="startBtn">é–‹å§‹ç·´ç¿’</button>

    <div id="quiz" style="display:none;">
        <div class="kana" id="kana"></div>
        <input id="answer" placeholder="è¼¸å…¥ç¾…é¦¬æ‹¼éŸ³" onkeydown="if(event.key==='Enter') checkAnswer()">
        <button onclick="checkAnswer()" id="submitBtn">é€å‡º</button>
        <div class="result" id="feedback"></div>
    </div>

    <script>
        const chart = [
            ["ã‚", "a"], ["ã„", "i"], ["ã†", "u"], ["ãˆ", "e"], ["ãŠ", "o"],
            ["ã‹", "ka"], ["ã", "ki"], ["ã", "ku"], ["ã‘", "ke"], ["ã“", "ko"],
            ["ã•", "sa"], ["ã—", "shi"], ["ã™", "su"], ["ã›", "se"], ["ã", "so"],
            ["ãŸ", "ta"], ["ã¡", "chi"], ["ã¤", "tsu"], ["ã¦", "te"], ["ã¨", "to"],
            ["ãª", "na"], ["ã«", "ni"], ["ã¬", "nu"], ["ã­", "ne"], ["ã®", "no"],
            ["ã¯", "ha"], ["ã²", "hi"], ["ãµ", "fu"], ["ã¸", "he"], ["ã»", "ho"],
            ["ã¾", "ma"], ["ã¿", "mi"], ["ã‚€", "mu"], ["ã‚", "me"], ["ã‚‚", "mo"],
            ["ã‚„", "ya"], ["ã‚†", "yu"], ["ã‚ˆ", "yo"],
            ["ã‚‰", "ra"], ["ã‚Š", "ri"], ["ã‚‹", "ru"], ["ã‚Œ", "re"], ["ã‚", "ro"],
            ["ã‚", "wa"], ["ã‚’", "wo"], ["ã‚“", "n"]
        ];

        let selected = [], current = 0, score = 0;
        let lang = "zh";

        const texts = {
            zh: {
                title: "ğŸŒ æ—¥æ–‡äº”åéŸ³ç·´ç¿’å™¨",
                instructions: "è¼¸å…¥èµ·å§‹èˆ‡çµæŸå‡åï¼ˆä¾‹å¦‚ï¼šã‚ åˆ° ã“ï¼‰ï¼š",
                startBtn: "é–‹å§‹ç·´ç¿’",
                submitBtn: "é€å‡º",
                correct: "âœ… æ­£ç¢ºï¼",
                wrong: (correct) => `âŒ éŒ¯èª¤ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ ${correct}`,
                score: (score, total) => `ğŸ¯ å¾—åˆ†ï¼š${score} / ${total}`,
                alert: "âš ï¸ å‡åè¼¸å…¥éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ï¼",
                inputPlaceholder: "è¼¸å…¥ç¾…é¦¬æ‹¼éŸ³"
            },
            en: {
                title: "ğŸŒ Hiragana Practice Tool",
                instructions: "Enter start and end kana (e.g., ã‚ to ã“):",
                startBtn: "Start Quiz",
                submitBtn: "Submit",
                correct: "âœ… Correct!",
                wrong: (correct) => `âŒ Incorrect, correct answer: ${correct}`,
                score: (score, total) => `ğŸ¯ Score: ${score} / ${total}`,
                alert: "âš ï¸ Invalid kana range!",
                inputPlaceholder: "Enter romaji"
            }
        };

        function setLanguage() {
            lang = document.getElementById("language").value;
            document.getElementById("title").innerText = texts[lang].title;
            document.getElementById("instructions").innerText = texts[lang].instructions;
            document.getElementById("startBtn").innerText = texts[lang].startBtn;
            document.getElementById("submitBtn").innerText = texts[lang].submitBtn;
            document.getElementById("answer").placeholder = texts[lang].inputPlaceholder;
        }

        function startQuiz() {
            const startKana = document.getElementById("start").value;
            const endKana = document.getElementById("end").value;
            const startIndex = chart.findIndex(p => p[0] === startKana);
            const endIndex = chart.findIndex(p => p[0] === endKana);
            if (startIndex === -1 || endIndex === -1 || startIndex > endIndex) {
                alert(texts[lang].alert);
                return;
            }
            selected = chart.slice(startIndex, endIndex + 1);
            selected = shuffle(selected);
            current = 0;
            score = 0;
            document.getElementById("quiz").style.display = "block";
            document.getElementById("feedback").innerText = "";
            nextQuestion();
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function nextQuestion() {
            if (current >= selected.length) {
                document.getElementById("kana").innerText = texts[lang].score(score, selected.length);
                document.getElementById("answer").style.display = "none";
                document.getElementById("submitBtn").style.display = "none";
                return;
            }
            document.getElementById("kana").innerText = selected[current][0];
            document.getElementById("answer").value = "";
            document.getElementById("answer").focus();
        }

        function checkAnswer() {
            const user = document.getElementById("answer").value.trim().toLowerCase();
            const correct = selected[current][1];
            const feedback = document.getElementById("feedback");
            if (user === correct) {
                feedback.innerText = texts[lang].correct;
                score++;
            } else {
                feedback.innerText = texts[lang].wrong(correct);
            }
            current++;
            setTimeout(() => {
                feedback.innerText = "";
                nextQuestion();
            }, 1000);
        }

        window.onload = setLanguage;
    
        const romajiToKana = {'a': 'ã‚', 'i': 'ã„', 'u': 'ã†', 'e': 'ãˆ', 'o': 'ãŠ', 'ka': 'ã‹', 'ki': 'ã', 'ku': 'ã', 'ke': 'ã‘', 'ko': 'ã“', 'sa': 'ã•', 'shi': 'ã—', 'su': 'ã™', 'se': 'ã›', 'so': 'ã', 'ta': 'ãŸ', 'chi': 'ã¡', 'tsu': 'ã¤', 'te': 'ã¦', 'to': 'ã¨', 'na': 'ãª', 'ni': 'ã«', 'nu': 'ã¬', 'ne': 'ã­', 'no': 'ã®', 'ha': 'ã¯', 'hi': 'ã²', 'fu': 'ãµ', 'he': 'ã¸', 'ho': 'ã»', 'ma': 'ã¾', 'mi': 'ã¿', 'mu': 'ã‚€', 'me': 'ã‚', 'mo': 'ã‚‚', 'ya': 'ã‚„', 'yu': 'ã‚†', 'yo': 'ã‚ˆ', 'ra': 'ã‚‰', 'ri': 'ã‚Š', 'ru': 'ã‚‹', 're': 'ã‚Œ', 'ro': 'ã‚', 'wa': 'ã‚', 'wo': 'ã‚’', 'n': 'ã‚“'};

        function normalizeKana(input) {
            if (chart.find(p => p[0] === input)) return input;
            return romajiToKana[input.toLowerCase()] || "";
        }

        function startQuiz() {
            const startKana = normalizeKana(document.getElementById("start").value.trim());
            const endKana = normalizeKana(document.getElementById("end").value.trim());
            const startIndex = chart.findIndex(p => p[0] === startKana);
            const endIndex = chart.findIndex(p => p[0] === endKana);
            if (startIndex === -1 || endIndex === -1 || startIndex > endIndex) {
                alert(texts[lang].alert);
                return;
            }
            selected = chart.slice(startIndex, endIndex + 1);
            selected = shuffle(selected);
            current = 0;
            score = 0;
            document.getElementById("quiz").style.display = "block";
            document.getElementById("feedback").innerText = "";
            nextQuestion();
        }

        function setLanguage() {
            lang = document.getElementById("language").value;
            document.getElementById("title").innerText = texts[lang].title;
            document.getElementById("instructions").innerText = texts[lang].instructions;
            document.getElementById("startBtn").innerText = texts[lang].startBtn;
            document.getElementById("submitBtn").innerText = texts[lang].submitBtn;
            document.getElementById("answer").placeholder = texts[lang].inputPlaceholder;
            document.getElementById("start").placeholder = lang === 'en' ? 'Start kana (e.g. a)' : 'èµ·å§‹å‡å';
            document.getElementById("end").placeholder = lang === 'en' ? 'End kana (e.g. ko)' : 'çµæŸå‡å';
        }
        </script>
</body>
</html>
